name: "LLM Router Platform CodeQL Config"

# Use the default queries plus security-extended
queries:
  - uses: security-extended

# Define paths to ignore
paths-ignore:
  - '**/vendor/**'
  - '**/testdata/**'

# Query filters to manage specific findings
query-filters:
  # Exclude log injection findings in middleware where we have proper sanitization
  # The sanitizeLogString function uses url.QueryEscape which escapes all dangerous chars
  - exclude:
      id: go/log-injection
      paths:
        - server/internal/api/middleware/middleware.go

  # Exclude weak hashing alert for API key hashing
  # Justification: API keys are 128+ bit high-entropy random strings generated by us,
  # not user-chosen passwords. SHA-256 is cryptographically appropriate here because:
  # 1. We need O(1) lookup by hash (bcrypt doesn't support this)
  # 2. High-entropy secrets don't need slow hashing - dictionary attacks are infeasible
  # 3. The key space is 2^128, making brute force impractical
  - exclude:
      id: go/weak-sensitive-data-hashing
      paths:
        - server/internal/service/user/user.go
